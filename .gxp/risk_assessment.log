# ROSIE Middleware Platform - Risk Assessment Log
# RFC-001 SS3 Compliance - Deterministic Risk Register
# System: ROSIE Middleware Platform v0.1.0
# GxP Risk Rating: HIGH
# Last Updated: 2026-02-05
# Owner: PharmaLedger Association (compliance@pharmaledger.org)
# ============================================================================
# Format: [DATE] RISK-ID | REQ-ID | Risk: LEVEL | Impact: ... | Mitigation: ... | Test Coverage: SPEC-ID
# ============================================================================

# --- Requirement-Linked Risks ---

[2026-02-05] RISK-001 | REQ-001 | Risk: MEDIUM | Impact: Incorrect repository registration could cause scanning of wrong repositories or missed repositories; cascading deletes could remove compliance evidence and break audit trail integrity | Mitigation: URL validation before registration; unique constraint on git_url prevents duplicates; soft delete preserves audit trail; integration tests cover CRUD operations and database constraints | Test Coverage: SPEC-001-001, SPEC-007-001

[2026-02-05] RISK-002 | REQ-002 | Risk: HIGH | Impact: Scanning wrong commit SHA validates different code than intended; missing artifacts produce incomplete compliance picture; unverified content could allow tampered files into validation pipeline; rate limit exhaustion blocks all scanning operations | Mitigation: Commit SHA verification on every fetch; exponential backoff for rate limits; batch requests (10 files/batch) to reduce API consumption; HTTPS enforced for all GitHub API calls; tokens stored in environment variables, never logged or exposed | Test Coverage: SPEC-002-001, SPEC-002-002

[2026-02-05] RISK-003 | REQ-003 | Risk: HIGH | Impact: Missing system_context.md prevents establishing system boundary or risk rating; misclassified artifact types cause wrong parser to be applied; missed artifact files produce incomplete traceability chains and false negatives in compliance reporting | Mitigation: Explicit path pattern matching for each artifact type (REQ-*.md, US-*.md, SPEC-*.md, *.jws); mandatory system_context.md check before proceeding; warnings logged for missing subdirectories; artifact count summary included in scan results for manual verification | Test Coverage: SPEC-003-001, SPEC-004-003

[2026-02-05] RISK-004 | REQ-004 | Risk: HIGH | Impact: Missing gxp_id extraction breaks traceability links creating orphan artifacts; incorrect parent_id parsing breaks traceability chains producing false negatives; failed YAML parsing excludes artifacts from validation giving incomplete compliance picture; malformed JWS parsing prevents cryptographic evidence verification | Mitigation: gray-matter library for robust YAML extraction; graceful error handling (log and continue, do not crash scan); field name normalization supports both snake_case and camelCase; artifacts marked as incomplete or parse_error in database rather than silently dropped | Test Coverage: SPEC-004-001, SPEC-004-002

[2026-02-05] RISK-005 | REQ-005 | Risk: HIGH | Impact: Partial transactions create incomplete artifact sets with broken traceability chains; missing foreign keys produce orphan artifacts with invalid parent references; absent audit trail prevents tracing when/why artifacts were modified; duplicate artifacts cause confusion over canonical versions | Mitigation: Atomic database transactions wrap all artifact inserts (all-or-nothing); foreign key constraints enforced via Drizzle ORM schema; immutable append-only audit_log table records all write operations; unique constraint on (repository_id, gxp_id) prevents duplicates with upsert on conflict; performance indexes on traceability fields | Test Coverage: SPEC-005-001, SPEC-INF-001

[2026-02-05] RISK-006 | REQ-006 | Risk: MEDIUM | Impact: Incorrect phase ordering could skip validation and produce invalid results; missing error handling could crash the system and lose scan progress; absent status tracking prevents debugging failed scans or monitoring progress | Mitigation: 6-phase pipeline enforced sequentially (Discovery -> Fetch -> Parse -> Validate -> Persist -> Notify); try/catch at each phase with scan status updated to "failed" on error; scan metrics (duration_ms, artifacts_found, commit_sha) recorded for every scan; concurrent scan prevention on same repository | Test Coverage: SPEC-006-001, SPEC-006-001-001

[2026-02-05] RISK-007 | REQ-007 | Risk: MEDIUM | Impact: Incorrect filtering returns wrong artifacts giving incomplete compliance picture; missing pagination causes slow performance for large repositories; invalid query results produce incorrect traceability analysis | Mitigation: Zod/class-validator input validation on all query parameters; paginated responses with total count metadata; consistent JSON response format across all endpoints; 404/400/500 error codes with descriptive messages; rate limiting via NestJS Throttler | Test Coverage: SPEC-007-001, SPEC-007-002

[2026-02-05] RISK-008 | REQ-008 | Risk: LOW | Impact: Incorrect data display could confuse users but underlying data remains correct; missing UI features reduce usability but REST API provides full backup access; visual bugs are cosmetic with no impact on validation accuracy | Mitigation: UI is read-only presentation layer with no write access to validation logic; all data served through validated REST API endpoints; TanStack Query provides client-side caching and error handling; responsive design tested at desktop and tablet viewports | Test Coverage: SPEC-008-001, SPEC-008-002, SPEC-008-003

# --- Infrastructure Risks ---

[2026-02-05] RISK-INF-001 | INFRA | Risk: HIGH | Impact: Signing key compromise would allow forged JWS evidence artifacts, undermining cryptographic non-repudiation required by 21 CFR Part 11 SS 11.50; forged evidence could certify non-compliant systems as validated | Mitigation: ES256 (ECDSA P-256) algorithm chosen for evidence signing — industry-standard asymmetric cryptography; signing keys stored as environment variables on Railway, never committed to source control or database; key rotation procedure documented; JWS header includes key ID (kid) for rotation traceability; signature verification performed on every evidence artifact during scan parsing | Test Coverage: SPEC-004-002

[2026-02-05] RISK-INF-002 | INFRA | Risk: MEDIUM | Impact: Database migration failure could corrupt schema leaving application in inconsistent state; failed migration during deployment could cause downtime; schema drift between environments could produce different validation results | Mitigation: Drizzle ORM generates deterministic, version-controlled migration files; migrations run in transactions with automatic rollback on failure; Railway PostgreSQL provides automatic backups for point-in-time recovery; schema defined in TypeScript with compile-time type checking; migration status tracked in drizzle migration journal | Test Coverage: SPEC-INF-001, SPEC-INF-002

[2026-02-05] RISK-INF-003 | INFRA | Risk: HIGH | Impact: Evidence tampering could invalidate compliance audit trail; modified audit_log entries would violate 21 CFR Part 11 SS 11.10(c) immutability requirement; altered traceability links could produce false compliance reports | Mitigation: Audit log table is append-only (no UPDATE or DELETE operations permitted); JWS evidence artifacts include cryptographic signatures (ES256) for tamper detection; database-level constraints prevent audit record modification; payload_hash stored in audit_log enables integrity verification; atomic transactions ensure consistent state — partial modifications are rolled back | Test Coverage: SPEC-005-001, SPEC-004-002
